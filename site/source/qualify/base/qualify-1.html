{% extends "base/layout.html" %}

{% block title %}{{ super() }} - Demande d'autorisation provisoire de travail{% endblock %}

{% block content %}

    <main id="skip-to-main">

        <section class="section-white">

            <div class="aerate-content">

                <h2>Demande d'autorisation provisoire de travail</h2>

                <form class="js-qualify-form" action="{% block form_action %}{% endblock %}" method="get">

                    <p>
                        <label for="department">Département qui figure sur le titre de séjour du salarié :</label>
                        <select id="department" name="department" autofocus>
                          <option value="">Choisissez votre département</option>
                          <option value=""></option>
                          <option value="10">10 - Aube</option>
                          <option value="13">13 - Bouches-du-Rhône</option>
                          <option value="25">25 - Doubs</option>
                          <option value="35">35 - Ille-et-vilaine</option>
                          <option value="42">42 - Loire</option>
                          <option value="45">45 - Loiret</option>
                          <option value="52">52 - Haute-marne</option>
                          <option value="54">54 - Meurthe-et-moselle</option>
                          <option value="55">55 - Meuse</option>
                          <option value="57">57 - Moselle</option>
                          <option value="63">63 - Puy-de-dôme</option>
                          <option value="67">67 - Bas-rhin</option>
                          <option value="68">68 - Haut-rhin</option>
                          <option value="69">69 - Rhône</option>
                          <option value="75">75 - Paris</option>
                          <option value="76">76 - Seine-maritime</option>
                          <option value="77">77 - Seine-et-marne</option>
                          <option value="78">78 - Yvelines</option>
                          <option value="88">88 - Vosges</option>
                          <option value="91">91 - Essonne</option>
                          <option value="92">92 - Hauts-de-seine</option>
                          <option value="93">93 - Seine-Saint-Denis</option>
                          <option value="94">94 - Val-de-marne</option>
                          <option value="95">95 - Val-d'oise</option>
                          <option value=""></option>
                          <option value="01">01 - Ain</option>
                          <option value="02">02 - Aisne</option>
                          <option value="03">03 - Allier</option>
                          <option value="04">04 - Alpes-de-Haute-Provence</option>
                          <option value="05">05 - Hautes-alpes</option>
                          <option value="06">06 - Alpes-maritimes</option>
                          <option value="07">07 - Ardèche</option>
                          <option value="08">08 - Ardennes</option>
                          <option value="09">09 - Ariège</option>
                          <option value="10">10 - Aube</option>
                          <option value="11">11 - Aude</option>
                          <option value="12">12 - Aveyron</option>
                          <option value="13">13 - Bouches-du-Rhône</option>
                          <option value="14">14 - Calvados</option>
                          <option value="15">15 - Cantal</option>
                          <option value="16">16 - Charente</option>
                          <option value="17">17 - Charente-maritime</option>
                          <option value="18">18 - Cher</option>
                          <option value="19">19 - Corrèze</option>
                          <option value="2a">2a - Corse-du-sud</option>
                          <option value="2b">2b - Haute-Corse</option>
                          <option value="21">21 - Côte-d'Or</option>
                          <option value="22">22 - Côtes-d'Armor</option>
                          <option value="23">23 - Creuse</option>
                          <option value="24">24 - Dordogne</option>
                          <option value="25">25 - Doubs</option>
                          <option value="26">26 - Drôme</option>
                          <option value="27">27 - Eure</option>
                          <option value="28">28 - Eure-et-loir</option>
                          <option value="29">29 - Finistère</option>
                          <option value="30">30 - Gard</option>
                          <option value="31">31 - Haute-garonne</option>
                          <option value="32">32 - Gers</option>
                          <option value="33">33 - Gironde</option>
                          <option value="34">34 - Hérault</option>
                          <option value="35">35 - Ille-et-vilaine</option>
                          <option value="36">36 - Indre</option>
                          <option value="37">37 - Indre-et-loire</option>
                          <option value="38">38 - Isère</option>
                          <option value="39">39 - Jura</option>
                          <option value="40">40 - Landes</option>
                          <option value="41">41 - Loir-et-cher</option>
                          <option value="42">42 - Loire</option>
                          <option value="43">43 - Haute-loire</option>
                          <option value="44">44 - Loire-atlantique</option>
                          <option value="45">45 - Loiret</option>
                          <option value="46">46 - Lot</option>
                          <option value="47">47 - Lot-et-garonne</option>
                          <option value="48">48 - Lozère</option>
                          <option value="49">49 - Maine-et-loire</option>
                          <option value="50">50 - Manche</option>
                          <option value="51">51 - Marne</option>
                          <option value="52">52 - Haute-marne</option>
                          <option value="53">53 - Mayenne</option>
                          <option value="54">54 - Meurthe-et-moselle</option>
                          <option value="55">55 - Meuse</option>
                          <option value="56">56 - Morbihan</option>
                          <option value="57">57 - Moselle</option>
                          <option value="58">58 - Nièvre</option>
                          <option value="59">59 - Nord</option>
                          <option value="60">60 - Oise</option>
                          <option value="61">61 - Orne</option>
                          <option value="62">62 - Pas-de-calais</option>
                          <option value="63">63 - Puy-de-dôme</option>
                          <option value="64">64 - Pyrénées-atlantiques</option>
                          <option value="65">65 - Hautes-Pyrénées</option>
                          <option value="66">66 - Pyrénées-orientales</option>
                          <option value="67">67 - Bas-rhin</option>
                          <option value="68">68 - Haut-rhin</option>
                          <option value="69">69 - Rhône</option>
                          <option value="70">70 - Haute-saône</option>
                          <option value="71">71 - Saône-et-loire</option>
                          <option value="72">72 - Sarthe</option>
                          <option value="73">73 - Savoie</option>
                          <option value="74">74 - Haute-savoie</option>
                          <option value="75">75 - Paris</option>
                          <option value="76">76 - Seine-maritime</option>
                          <option value="77">77 - Seine-et-marne</option>
                          <option value="78">78 - Yvelines</option>
                          <option value="79">79 - Deux-sèvres</option>
                          <option value="80">80 - Somme</option>
                          <option value="81">81 - Tarn</option>
                          <option value="82">82 - Tarn-et-garonne</option>
                          <option value="83">83 - Var</option>
                          <option value="84">84 - Vaucluse</option>
                          <option value="85">85 - Vendée</option>
                          <option value="86">86 - Vienne</option>
                          <option value="87">87 - Haute-vienne</option>
                          <option value="88">88 - Vosges</option>
                          <option value="89">89 - Yonne</option>
                          <option value="90">90 - Territoire de belfort</option>
                          <option value="91">91 - Essonne</option>
                          <option value="92">92 - Hauts-de-seine</option>
                          <option value="93">93 - Seine-Saint-Denis</option>
                          <option value="94">94 - Val-de-marne</option>
                          <option value="95">95 - Val-d'oise</option>
                          <option value="971">97 - Guadeloupe</option>
                          <option value="972">97 - Martinique</option>
                          <option value="973">97 - Guyane</option>
                          <option value="974">97 - La réunion</option>
                          <option value="975">97 - Saint-Pierre-et-Miquelon</option>
                          <option value="976">97 - Mayotte</option>
                        </select>
                    </p>

                    <p>
                        <button type="submit" class="btn">Continuer</button>
                    </p>

                </form>

            </div>

        </section>

    </main>

{% endblock %}

{% block script %}
    {{ super() }}
    <script>

        let form = document.querySelector('.js-qualify-form');

        let validateForm = function (e) {
          e.preventDefault();
          e.stopPropagation();
          let department = document.querySelector('#department option:checked').value;
          if (!department) {
            alert("Merci de choisir votre département");
            return false;
          }
          const allowedDepartements = ['75','69','45','77','95','92','13','76','91','78','54','88','57','67','94','10','93','42','55','35','52','63','68','25']
          if (allowedDepartements.indexOf(department) === -1) {
            form.action = '/qualify/fail.html';
          }
          form.submit();
        }

        if (form) {
          form.addEventListener('submit', validateForm);
        }

    </script>
{% endblock %}
